(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"4d7e":function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));n("8e6e"),n("8a81"),n("ac6a"),n("cadf"),n("06db"),n("456d");var r=n("c47a"),c=n.n(r),i=n("1a84"),a=n("e439"),o=(n("7514"),n("2f62"));function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var u={computed:l({},Object(o.c)(["configuration"])),methods:l({},Object(o.b)(["_connections","_myStream","_dropConnection","_streamTracks","_resetParams","_resetConference"]),{RtcCreateFrom:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return n&&console.log(n,"implement renegotiation"),e.stream.rtc||(e.stream.rtc=new RTCPeerConnection(this.configuration.connection)),e.stream.emitCallTrack||(e.stream.emitCallTrack=function(e){t.$socket.emit("callTrack",e)}),this.setEvents(e),this.attachStream(e),e},attachStream:function(e){var t=this;this.getMediaStream().then((function(n){t.setTracks(e,n),e.stream.tracks=[],e.stream.data=n,e.stream.gain=0,t._streamTracks(n),t._myStream({active:!0,stream:n}),t.offer(e,n)})).catch((function(e){console.log(e)}))},setTracks:function(e,t){t.getTracks().forEach((function(n){e.stream.rtc.getSenders().length>1?e.stream.rtc.getSenders().find((function(e){return e.track.kind===n.kind})).replaceTrack(n):e.stream.rtc.addTrack(n,t)}))},setEvents:function(e){var t=this,n=!1;e.stream.rtc.onicecandidate=function(n){n.candidate&&t.$socket.emit("iceDistribution",{peer:e,candidate:n.candidate,authorization:t.user})},e.stream.rtc.addEventListener("icegatheringstatechange",(function(e){}),!1),e.stream.rtc.onnegotiationneeded=function(r){n||"stable"!=e.stream.rtc.signalingState||(n=!0,e.stream.sdp||(e.qcandidates=[],t.RtcCreateFrom(e,!0)))},e.stream.rtc.addEventListener("connectionstatechange",(function(n){e.stream.rtc.connectionState,"disconnected"!==e.stream.rtc.connectionState&&"closed"!==e.stream.rtc.connectionState||t._dropConnection(e)})),e.stream.rtc.ontrack=function(n){t._connections({data:e,gain:0,stream:n.streams[0]})}}})};function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d={mixins:[u],computed:m({},Object(o.c)(["configuration","conference","callStatus"]),{pending:function(){return this.configuration.pending}}),methods:m({},Object(o.b)(["_streamTracks","_myStream"]),{RtcAnswerFrom:function(e){var t=this,n=this.pending.find((function(t){return t._id===e._id}));n||this.pending.push(e),e.qcandidates?n=e:e.qcandidates=[],e.stream.rtc||(e.stream.rtc=new RTCPeerConnection(this.configuration.connection)),e.stream.emitCallTrack=function(e){t.$socket.emit("callTrack",e)},this.onAnswer(e)},onAnswer:function(e){var t=this;this.setEvents(e),this.getMediaStream().then((function(n){e.stream.tracks=[],t._streamTracks(n);try{t._myStream({active:!0,stream:n}),t.setTracks(e,n),t.answer(e)}catch(e){console.log(e)}}))},answer:function(e){var t=this;e.stream.rtc.setRemoteDescription(new RTCSessionDescription(e.stream.sdp)).then((function(){return e.qcandidates.map((function(t){e.stream.rtc.addIceCandidate(new RTCIceCandidate(t)).catch((function(e){console.log("@@ICE ERROR",e.message)}))})),e.stream.rtc.createAnswer()})).catch((function(e){console.log("eee",e.message)})).then((function(t){return e.stream.rtc.setLocalDescription(t)})).then((function(){e.stream.emitData={conference:t.conference._id,peer:e._id,init:"answer",authorization:t.user._id,sdp:e.stream.rtc.localDescription},3!==t.callStatus?t.template.center.load="videos":(e.stream.emitCallTrack(e.stream.emitData),t.template.center.load="streams")})).catch((function(t){console.log("".concat(t," from ").concat(e.email))}))}})};function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h={mixins:[i.a,a.a,d,u],computed:g({},Object(o.c)(["configuration","callStatus"])),methods:g({},Object(o.b)(["_streamTracks","_myStream"]),{offer:function(e,t){var n=this;e.stream.rtc.createOffer().then((function(t){return e.stream.rtc.setLocalDescription(new RTCSessionDescription(t))})).then((function(){e.stream.emitCallTrack({conference:n.conference._id,peer:e._id,init:"call",authorization:n.user._id,sdp:e.stream.rtc.localDescription}),3!==n.callStatus?n.template.center.load="videos":n.template.center.load="streams"})).catch((function(e){console.log(e)}))}})}},"7726e":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));n("8e6e"),n("8a81"),n("ac6a"),n("cadf"),n("06db"),n("456d"),n("7514");var r=n("c47a"),c=n.n(r),i=n("3840"),a=n("2f62");function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l={mixins:[i.b],computed:s({},Object(a.c)(["conference","rooms","activeTable"])),methods:s({},Object(a.b)(["_conference","_table"])),sockets:{invitation:function(e){if(null===this.activeTable.tableId){var t=e.tableId,n=e.initiator,r=e.invites,c=e.settings;this._table({tableId:t,initiator:n,invites:r,settings:c}),this.template.center.load="videos"}},incomingConversationRequest:function(e){e._id!==this.conference._id&&0!==this.conference._id||(this._conference(e),e.initiator===this.user._id&&this.initiateCallRequest(e))},pullIncomingRelay:function(e){e._id!==this.conference._id&&0!==this.conference._id||(this._conference(e),e.pending.length>0&&this.relayPendingConference(e))},conferenceRequest:function(e){e._s._id===this.conference._id&&(this._conference(e._s),this.initiateCallResponse(e))},iceCandidateRegistry:function(e){this.registerIcePeering(e)},onGestures:function(e){e.user=this.rooms.members.find((function(t){return t._id===e.authorization})),e.displayed=!1,this.conference.data.gestures.push(e)},acceptIncomingConverse:function(e){e._s._id===this.conference._id&&this._conference(e._s),this.linkPeerSdp(e.data)}}}},7957:function(e,t,n){"use strict";n.r(t);n("8e6e"),n("8a81"),n("ac6a"),n("cadf"),n("06db"),n("456d");var r=n("c47a"),c=n.n(r),i=(n("bc3a"),n("2f62")),a=n("7726e"),o=n("5f02"),s=n("4d7e");n("e854");function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var u={mixins:[a.a,o.a,s.a],watch:{pageLoad:{handler:function(e){"videos"===e.center.load?this.playBack.play():(this.playBack.pause(),this.playBack.currentTime=0)},deep:!0},community:{handler:function(e){},deep:!0}},computed:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(i.c)(["template","globalDisplay"]),{community:function(){return this.$community},config:function(){return this.globalDisplay},room:function(){return this.$community.room},messages:function(){return this.room.messages},loaded:function(){return this.CommunityLoading.messages},pageLoad:function(){return this.template}}),data:function(){return{ringTone:"statics/swinging.ogg",playBack:null,firstLoad:!0,user:{id:"",name:"",avatar:"https://tattooimages.biz/images/gallery/Upset_geometric_panda_in_profile_tattoo_design.png",abbr:!0},com:{}}},methods:{scrollMessage:function(){var e=this.$refs.scrollMessage.scrollSize,t=this.$refs.scrollMessage.getScrollPosition(),n=.3*e;this.firstLoad&&(n=0,e+=9999,this.firstLoad=!1),(t>n||20===this.$refs.scrollMessage.scrollSize)&&this.$refs.scrollMessage.setScrollPosition(1001*e,300)},onLoad:function(e,t){setTimeout((function(){console.log("loading messages!!!",e),t()}),2e3)},setBoardStyle:function(){var e="height:100%;background-color:".concat(this.config.messagePanel.board.main.primary,";");return""===this.config.messagePanel.board.main.background&&null===this.config.messagePanel.board.main.background||(e+="background-repeat: no-repeat; background-size: cover;background-image: url(".concat(this.config.messagePanel.board.main.background,")")),e}},sockets:{new_conference:function(e){this.$community.room.status.toolbar=!0,this.$community.room.pushConference(e)},update_conference:function(e){this.$community.room.getAllConference()}},mounted:function(){}},f=n("2877"),m=Object(f.a)(u,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-page",{staticStyle:{width:"100%",height:"78vh"}},[n("userInfoDialog"),n("invite-member"),n("avatarMenu"),n("div",{style:"display:flex; flex-direction:column; height:100% ; width:100%; background:"+e.config.messagePanel.board.main.primary},[n("transition",{staticStyle:{height:"100%"},attrs:{appear:"","enter-active-class":"animated slideInLeft"}},["messages"===e.room.status.template.activeScreen?n("div",{staticStyle:{height:"100%"}},[e._appLoadStat.messages?n("messages",{staticStyle:{height:"100%"},attrs:{setScrollBottom:e.scrollMessage,config:e.config}}):e._e()],1):e._e()]),n("transition",{staticStyle:{height:"100%"},attrs:{appear:"","enter-active-class":"animated slideInLeft"}},["conference"===e.room.status.template.activeScreen?n("conference-table"):e._e()],1),n("transition",{staticStyle:{height:"100%"},attrs:{appear:"","enter-active-class":"animated slideInLeft"}},["streams"===e.template.center.load?n("streams",{style:"height:100%;"+e.setBoardStyle(),attrs:{config:e.config}}):e._e()],1)],1)],1)}),[],!1,null,null,null);t.default=m.exports}}]);