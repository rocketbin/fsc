(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[1],{"4d7e":function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));n("8e6e"),n("8a81"),n("ac6a"),n("cadf"),n("06db"),n("456d");var r=n("c47a"),c=n.n(r),a=n("1a84"),o=n("e439"),i=(n("7514"),n("2f62"));function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var s={computed:_objectSpread({},Object(i["c"])(["configuration"])),methods:_objectSpread({},Object(i["b"])(["_connections","_myStream","_dropConnection","_streamTracks","_resetParams","_resetConference"]),{RtcCreateFrom:function RtcCreateFrom(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return n&&console.log(n,"implement renegotiation"),e.stream.rtc||(e.stream.rtc=new RTCPeerConnection(this.configuration.connection)),e.stream.emitCallTrack||(e.stream.emitCallTrack=function(e){t.$socket.emit("callTrack",e)}),this.setEvents(e),this.attachStream(e),e},attachStream:function attachStream(e){var t=this;this.getMediaStream().then((function(n){t.setTracks(e,n),e.stream.tracks=[],e.stream.data=n,e.stream.gain=0,t._streamTracks(n),t._myStream({active:!0,stream:n}),t.offer(e,n)})).catch((function(e){console.log(e)}))},setTracks:function setTracks(e,t){t.getTracks().forEach((function(n){var r=e.stream.rtc.getSenders();if(r.length>1){var c=e.stream.rtc.getSenders().find((function(e){return e.track.kind===n.kind}));c.replaceTrack(n)}else e.stream.rtc.addTrack(n,t)}))},setEvents:function setEvents(e){var t=this,n=!1;e.stream.rtc.onicecandidate=function(n){n.candidate&&t.$socket.emit("iceDistribution",{peer:e,candidate:n.candidate,authorization:t.user})},e.stream.rtc.addEventListener("icegatheringstatechange",(function(e){}),!1),e.stream.rtc.onnegotiationneeded=function(r){n||"stable"!=e.stream.rtc.signalingState||(n=!0,e.stream.sdp||(e.qcandidates=[],t.RtcCreateFrom(e,!0)))},e.stream.rtc.addEventListener("connectionstatechange",(function(n){e.stream.rtc.connectionState,"disconnected"!==e.stream.rtc.connectionState&&"closed"!==e.stream.rtc.connectionState||t._dropConnection(e)})),e.stream.rtc.ontrack=function(n){t._connections({data:e,gain:0,stream:n.streams[0]})}}})};function answer_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function answer_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?answer_ownKeys(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):answer_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l={mixins:[s],computed:answer_objectSpread({},Object(i["c"])(["configuration","conference","callStatus"]),{pending:function pending(){return this.configuration.pending}}),methods:answer_objectSpread({},Object(i["b"])(["_streamTracks","_myStream"]),{RtcAnswerFrom:function RtcAnswerFrom(e){var t=this,n=this.pending.find((function(t){return t._id===e._id}));n||this.pending.push(e),e.qcandidates?n=e:e.qcandidates=[],e.stream.rtc||(e.stream.rtc=new RTCPeerConnection(this.configuration.connection)),e.stream.emitCallTrack=function(e){t.$socket.emit("callTrack",e)},this.onAnswer(e)},onAnswer:function onAnswer(e){var t=this;this.setEvents(e),this.getMediaStream().then((function(n){e.stream.tracks=[],t._streamTracks(n);try{t._myStream({active:!0,stream:n}),t.setTracks(e,n),t.answer(e)}catch(r){console.log(r)}}))},answer:function answer(e){var t=this;e.stream.rtc.setRemoteDescription(new RTCSessionDescription(e.stream.sdp)).then((function(){return e.qcandidates.map((function(t){e.stream.rtc.addIceCandidate(new RTCIceCandidate(t)).catch((function(e){console.log("@@ICE ERROR",e.message)}))})),e.stream.rtc.createAnswer()})).catch((function(e){console.log("eee",e.message)})).then((function(t){return e.stream.rtc.setLocalDescription(t)})).then((function(){e.stream.emitData={conference:t.conference._id,peer:e._id,init:"answer",authorization:t.user._id,sdp:e.stream.rtc.localDescription},3!==t.callStatus?t.template.center.load="videos":(e.stream.emitCallTrack(e.stream.emitData),t.template.center.load="streams")})).catch((function(t){console.log("".concat(t," from ").concat(e.email))}))}})};function RtcManager_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function RtcManager_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?RtcManager_ownKeys(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):RtcManager_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var u={mixins:[a["a"],o["a"],l,s],computed:RtcManager_objectSpread({},Object(i["c"])(["configuration","callStatus"])),methods:RtcManager_objectSpread({},Object(i["b"])(["_streamTracks","_myStream"]),{offer:function offer(e,t){var n=this;e.stream.rtc.createOffer().then((function(t){return e.stream.rtc.setLocalDescription(new RTCSessionDescription(t))})).then((function(){e.stream.emitCallTrack({conference:n.conference._id,peer:e._id,init:"call",authorization:n.user._id,sdp:e.stream.rtc.localDescription}),3!==n.callStatus?n.template.center.load="videos":n.template.center.load="streams"})).catch((function(e){console.log(e)}))}})}},"7726e":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));n("8e6e"),n("8a81"),n("ac6a"),n("cadf"),n("06db"),n("456d"),n("7514");var r=n("c47a"),c=n.n(r),a=n("3840"),o=n("2f62");function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var i={mixins:[a["b"]],computed:_objectSpread({},Object(o["c"])(["conference","rooms","activeTable"])),methods:_objectSpread({},Object(o["b"])(["_conference","_table"])),sockets:{invitation:function invitation(e){if(null===this.activeTable.tableId){var t=e.tableId,n=e.initiator,r=e.invites,c=e.settings;this._table({tableId:t,initiator:n,invites:r,settings:c}),this.template.center.load="videos"}},incomingConversationRequest:function incomingConversationRequest(e){e._id!==this.conference._id&&0!==this.conference._id||(this._conference(e),e.initiator===this.user._id&&this.initiateCallRequest(e))},pullIncomingRelay:function pullIncomingRelay(e){e._id!==this.conference._id&&0!==this.conference._id||(this._conference(e),e.pending.length>0&&this.relayPendingConference(e))},conferenceRequest:function conferenceRequest(e){e._s._id===this.conference._id&&(this._conference(e._s),this.initiateCallResponse(e))},iceCandidateRegistry:function iceCandidateRegistry(e){this.registerIcePeering(e)},onGestures:function onGestures(e){e.user=this.rooms.members.find((function(t){return t._id===e.authorization})),e.displayed=!1,this.conference.data.gestures.push(e)},acceptIncomingConverse:function acceptIncomingConverse(e){e._s._id===this.conference._id&&this._conference(e._s),this.linkPeerSdp(e.data)}}}},7957:function(e,t,n){"use strict";n.r(t);var render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-page",{staticStyle:{width:"100%",height:"78vh"}},[n("userInfoDialog"),n("invite-member"),n("avatarMenu"),n("div",{style:"display:flex; flex-direction:column; height:100% ; width:100%; background:"+e.config.messagePanel.board.main.primary},[n("transition",{staticStyle:{height:"100%"},attrs:{appear:"","enter-active-class":"animated slideInLeft"}},["messages"===e.room.status.template.activeScreen?n("div",{staticStyle:{height:"100%"}},[e._appLoadStat.messages?n("messages",{staticStyle:{height:"100%"},attrs:{setScrollBottom:e.scrollMessage,config:e.config}}):e._e()],1):e._e()]),n("transition",{staticStyle:{height:"100%"},attrs:{appear:"","enter-active-class":"animated slideInLeft"}},["conference"===e.room.status.template.activeScreen?n("conference-table"):e._e()],1),n("transition",{staticStyle:{height:"100%"},attrs:{appear:"","enter-active-class":"animated slideInLeft"}},["streams"===e.template.center.load?n("streams",{style:"height:100%;"+e.setBoardStyle(),attrs:{config:e.config}}):e._e()],1)],1)],1)},r=[],c=(n("8e6e"),n("8a81"),n("ac6a"),n("cadf"),n("06db"),n("456d"),n("c47a")),a=n.n(c),o=(n("bc3a"),n("2f62")),i=n("7726e"),s=n("5f02"),l=n("4d7e");n("e854");function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var u={mixins:[i["a"],s["a"],l["a"]],watch:{pageLoad:{handler:function handler(e){"videos"===e.center.load?this.playBack.play():(this.playBack.pause(),this.playBack.currentTime=0)},deep:!0},community:{handler:function handler(e){},deep:!0}},computed:_objectSpread({},Object(o["c"])(["template","globalDisplay"]),{community:function community(){return this.$community},config:function config(){return this.globalDisplay},room:function room(){return this.$community.room},messages:function messages(){return this.room.messages},loaded:function loaded(){return this.CommunityLoading.messages},pageLoad:function pageLoad(){return this.template}}),data:function data(){return{ringTone:"statics/swinging.ogg",playBack:null,firstLoad:!0,user:{id:"",name:"",avatar:"https://tattooimages.biz/images/gallery/Upset_geometric_panda_in_profile_tattoo_design.png",abbr:!0},com:{}}},methods:{scrollMessage:function scrollMessage(){var e=this.$refs.scrollMessage.scrollSize,t=this.$refs.scrollMessage.getScrollPosition(),n=.3*e;this.firstLoad&&(n=0,e+=9999,this.firstLoad=!1),(t>n||20===this.$refs.scrollMessage.scrollSize)&&this.$refs.scrollMessage.setScrollPosition(1001*e,300)},onLoad:function onLoad(e,t){setTimeout((function(){console.log("loading messages!!!",e),t()}),2e3)},setBoardStyle:function setBoardStyle(){var e="height:100%;background-color:".concat(this.config.messagePanel.board.main.primary,";");return""===this.config.messagePanel.board.main.background&&null===this.config.messagePanel.board.main.background||(e+="background-repeat: no-repeat; background-size: cover;background-image: url(".concat(this.config.messagePanel.board.main.background,")")),e}},sockets:{new_conference:function new_conference(e){this.$community.room.status.toolbar=!0,this.$community.room.pushConference(e)},update_conference:function update_conference(e){this.$community.room.getAllConference()}},mounted:function mounted(){}},d=u,f=n("2877"),m=Object(f["a"])(d,render,r,!1,null,null,null);t["default"]=m.exports}}]);